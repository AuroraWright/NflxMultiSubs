(()=>{let e={};const t=chrome.runtime.connect({name:"settings"});t.onMessage.addListener((t=>{e=t.settings||e,r()}));const a=[{upperBaselinePos:.2,lowerBaselinePos:.8},{upperBaselinePos:.15,lowerBaselinePos:.85},{upperBaselinePos:.1,lowerBaselinePos:.9}],n=[{primaryImageScale:.55,primaryTextScale:.75},{primaryImageScale:.65,primaryTextScale:.85},{primaryImageScale:.75,primaryTextScale:.95},{primaryImageScale:.85,primaryTextScale:1.05},{primaryImageScale:.95,primaryTextScale:1.1}],c=[{secondaryImageScale:.35,secondaryTextScale:.85},{secondaryImageScale:.42,secondaryTextScale:.92},{secondaryImageScale:.5,secondaryTextScale:1},{secondaryImageScale:.6,secondaryTextScale:1.1},{secondaryImageScale:.8,secondaryTextScale:1.3}],s=[{secondaryLanguageMode:"disabled"},{secondaryLanguageMode:"audio"},{secondaryLanguageMode:"last"}];function o(){t.postMessage({settings:e})}function r(){if("complete"!==document.readyState)return;let t;[].forEach.call(document.querySelectorAll(".active"),(e=>{e.classList.remove("active")}));const o=a.findIndex((t=>t.lowerBaselinePos===e.lowerBaselinePos));-1!==o&&(t=document.querySelector(`.settings-layout > div[data-id="${o}"]`),t&&t.classList.add("active"));const r=n.findIndex((t=>t.primaryImageScale===e.primaryImageScale));-1!==r&&(t=document.querySelector(`.settings-primary-font-size div.font-size[data-id="${r}"]`),t&&t.classList.add("active")),document.getElementById("primary-color").value=e.primaryTextColor||"#ffffff";const d=c.findIndex((t=>t.secondaryImageScale===e.secondaryImageScale));-1!==d&&(t=document.querySelector(`.settings-secondary-font-size div.font-size[data-id="${d}"]`),t&&t.classList.add("active")),document.getElementById("secondary-color").value=e.secondaryTextColor||"#ffffff";const i=s.findIndex((t=>t.secondaryLanguageMode===e.secondaryLanguageMode));-1!==i&&(t=document.querySelector(`.settings-secondary-lang > div[data-id="${i}"]`),t&&t.classList.add("active"),e.secondaryLanguageLastUsed&&(document.getElementById("langcode").innerHTML=e.secondaryLanguageLastUsed.split("-")[0]))}window.addEventListener("load",(d=>{!function(){let e=document.querySelector("#version");e&&(e.textContent="2.3.3")}(),r();const i=document.querySelectorAll(".settings-layout > div");[].forEach.call(i,(t=>{const n=parseInt(t.getAttribute("data-id"));t.addEventListener("click",(t=>function(t){t<0||t>=a.length||(e=Object.assign(e,a[t]),o(),r())}(n)),!1)}));const l=document.querySelectorAll(".settings-primary-font-size div.font-size");[].forEach.call(l,(t=>{const a=parseInt(t.getAttribute("data-id"));t.addEventListener("click",(t=>function(t){t<0||t>=n.length||(e=Object.assign(e,n[t]),o(),r())}(a)),!1)}));const g=document.querySelectorAll(".settings-secondary-font-size div.font-size");[].forEach.call(g,(t=>{const a=parseInt(t.getAttribute("data-id"));t.addEventListener("click",(t=>function(t){t<0||t>=c.length||(e=Object.assign(e,c[t]),o(),r())}(a)),!1)})),document.getElementById("primary-color").onchange=t=>{var a;a=t.target.value,e=Object.assign(e,{primaryTextColor:a}),o(),r()},document.getElementById("secondary-color").onchange=t=>{var a;a=t.target.value,e=Object.assign(e,{secondaryTextColor:a}),o(),r()};const y=document.querySelectorAll(".settings-secondary-lang > div");[].forEach.call(y,(t=>{const a=parseInt(t.getAttribute("data-id"));t.addEventListener("click",(t=>function(t){t<0||t>=s.length||(e=Object.assign(e,s[t]),o(),r())}(a)),!1)})),document.getElementById("btnReset").addEventListener("click",(e=>{t.postMessage({settings:null})}),!1)}))})();